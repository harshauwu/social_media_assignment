[2023-10-08T05:09:13.239+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Reddit_Post_Comment_Dag.processed_comment_data_insert_task manual__2023-10-08T04:58:27.785729+00:00 [queued]>
[2023-10-08T05:09:13.254+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Reddit_Post_Comment_Dag.processed_comment_data_insert_task manual__2023-10-08T04:58:27.785729+00:00 [queued]>
[2023-10-08T05:09:13.256+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2023-10-08T05:09:13.272+0000] {taskinstance.py:1382} INFO - Executing <Task(ProcessCommentDataTableOperator): processed_comment_data_insert_task> on 2023-10-08 04:58:27.785729+00:00
[2023-10-08T05:09:13.282+0000] {standard_task_runner.py:57} INFO - Started process 285 to run task
[2023-10-08T05:09:13.288+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'Reddit_Post_Comment_Dag', 'processed_comment_data_insert_task', 'manual__2023-10-08T04:58:27.785729+00:00', '--job-id', '145', '--raw', '--subdir', 'DAGS_FOLDER/reddit_post_comment_dag.py', '--cfg-path', '/tmp/tmpk6xsomkn']
[2023-10-08T05:09:13.294+0000] {standard_task_runner.py:85} INFO - Job 145: Subtask processed_comment_data_insert_task
[2023-10-08T05:09:13.370+0000] {task_command.py:415} INFO - Running <TaskInstance: Reddit_Post_Comment_Dag.processed_comment_data_insert_task manual__2023-10-08T04:58:27.785729+00:00 [running]> on host 88aca7bb4134
[2023-10-08T05:09:13.772+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='Reddit_Post_Comment_Dag' AIRFLOW_CTX_TASK_ID='processed_comment_data_insert_task' AIRFLOW_CTX_EXECUTION_DATE='2023-10-08T04:58:27.785729+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-10-08T04:58:27.785729+00:00'
[2023-10-08T05:09:13.773+0000] {process_comment_data_table_operator.py:27} INFO - Executing CustomMySqlOperator with data from task: sentiment_analysis_task
[2023-10-08T05:09:13.790+0000] {sql.py:274} INFO - Executing: CREATE TABLE  IF NOT EXISTS reddit_post_comments(id INT AUTO_INCREMENT PRIMARY KEY,post_id INT NOT NULL, post_author VARCHAR(255) NOT NULL, comment_author VARCHAR(255) NOT NULL, comment_id INT NOT NULL, comment_body TEXT NOT NULL, comment_score INT NOT NULL, comment_created_utc DATETIME NOT NULL, comment_permalink VARCHAR(255) NOT NULL,is_root_comment BOOLEAN NOT NULL, comment_author_flair_text VARCHAR(255), sentiment_scores FLOAT, compound_sentiment FLOAT, sentiment VARCHAR(255))
[2023-10-08T05:09:13.798+0000] {base.py:73} INFO - Using connection ID 'mysql_connection' for task execution.
[2023-10-08T05:09:13.812+0000] {base.py:73} INFO - Using connection ID 'mysql_connection' for task execution.
[2023-10-08T05:09:13.833+0000] {sql.py:418} INFO - Running statement: CREATE TABLE  IF NOT EXISTS reddit_post_comments(id INT AUTO_INCREMENT PRIMARY KEY,post_id INT NOT NULL, post_author VARCHAR(255) NOT NULL, comment_author VARCHAR(255) NOT NULL, comment_id INT NOT NULL, comment_body TEXT NOT NULL, comment_score INT NOT NULL, comment_created_utc DATETIME NOT NULL, comment_permalink VARCHAR(255) NOT NULL,is_root_comment BOOLEAN NOT NULL, comment_author_flair_text VARCHAR(255), sentiment_scores FLOAT, compound_sentiment FLOAT, sentiment VARCHAR(255)), parameters: None
[2023-10-08T05:09:13.839+0000] {sql.py:427} INFO - Rows affected: 0
[2023-10-08T05:09:13.854+0000] {logging_mixin.py:151} INFO - mysql_connection
[2023-10-08T05:09:13.956+0000] {logging_mixin.py:151} INFO -      post_id post_author  ... compound_sentiment sentiment
0    15y4v3n  colonade17  ...             0.8442  positive
1    15y4v3n  colonade17  ...            -0.4019  negative
2    15y4v3n  colonade17  ...             0.0772  positive
3    15y4v3n  colonade17  ...             0.7031  positive
4    15y4v3n  colonade17  ...             0.6705  positive
..       ...         ...  ...                ...       ...
701  14x2lun      JOV_97  ...            -0.1027  negative
702  14x2lun      JOV_97  ...             0.0000   neutral
703  14x2lun      JOV_97  ...             0.0000   neutral
704  14x2lun      JOV_97  ...             0.1695  positive
705  14x2lun      JOV_97  ...             0.0000   neutral

[706 rows x 14 columns]
[2023-10-08T05:09:14.166+0000] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=Reddit_Post_Comment_Dag, task_id=processed_comment_data_insert_task, execution_date=20231008T045827, start_date=20231008T050913, end_date=20231008T050914
[2023-10-08T05:09:14.226+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2023-10-08T05:09:14.251+0000] {taskinstance.py:2784} INFO - 0 downstream tasks scheduled from follow-on schedule check
