[2023-10-08T06:31:03.036+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Reddit_Post_Comment_Dag.extract_post_comment_task manual__2023-10-08T06:11:44.193224+00:00 [queued]>
[2023-10-08T06:31:03.051+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Reddit_Post_Comment_Dag.extract_post_comment_task manual__2023-10-08T06:11:44.193224+00:00 [queued]>
[2023-10-08T06:31:03.053+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2023-10-08T06:31:03.071+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): extract_post_comment_task> on 2023-10-08 06:11:44.193224+00:00
[2023-10-08T06:31:03.088+0000] {standard_task_runner.py:57} INFO - Started process 1604 to run task
[2023-10-08T06:31:03.093+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'Reddit_Post_Comment_Dag', 'extract_post_comment_task', 'manual__2023-10-08T06:11:44.193224+00:00', '--job-id', '163', '--raw', '--subdir', 'DAGS_FOLDER/reddit_post_comment_dag.py', '--cfg-path', '/tmp/tmpu204i8b4']
[2023-10-08T06:31:03.102+0000] {standard_task_runner.py:85} INFO - Job 163: Subtask extract_post_comment_task
[2023-10-08T06:31:03.186+0000] {task_command.py:415} INFO - Running <TaskInstance: Reddit_Post_Comment_Dag.extract_post_comment_task manual__2023-10-08T06:11:44.193224+00:00 [running]> on host 88aca7bb4134
[2023-10-08T06:31:03.591+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='Reddit_Post_Comment_Dag' AIRFLOW_CTX_TASK_ID='extract_post_comment_task' AIRFLOW_CTX_EXECUTION_DATE='2023-10-08T06:11:44.193224+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-10-08T06:11:44.193224+00:00'
[2023-10-08T06:31:08.285+0000] {logging_mixin.py:151} INFO - i7ysevk
[2023-10-08T06:31:08.699+0000] {logging_mixin.py:151} INFO - i7yrcib
[2023-10-08T06:31:09.127+0000] {logging_mixin.py:151} INFO - i7yj0ny
[2023-10-08T06:31:09.645+0000] {logging_mixin.py:151} INFO - i7yllke
[2023-10-08T06:31:10.158+0000] {logging_mixin.py:151} INFO - i7yltnz
[2023-10-08T06:31:10.575+0000] {logging_mixin.py:151} INFO - i7ys4a9
[2023-10-08T06:31:10.955+0000] {logging_mixin.py:151} INFO - i7ykeab
[2023-10-08T06:31:11.596+0000] {logging_mixin.py:151} INFO - i7yvrtb
[2023-10-08T06:31:12.069+0000] {logging_mixin.py:151} INFO - i7yucyw
[2023-10-08T06:31:12.513+0000] {logging_mixin.py:151} INFO - i7yr7mz
[2023-10-08T06:31:12.922+0000] {logging_mixin.py:151} INFO - i7yrzp8
[2023-10-08T06:31:13.415+0000] {logging_mixin.py:151} INFO - i7yjdef
[2023-10-08T06:31:14.026+0000] {logging_mixin.py:151} INFO - i7yrohl
[2023-10-08T06:31:14.544+0000] {logging_mixin.py:151} INFO - i7yzph2
[2023-10-08T06:31:15.054+0000] {logging_mixin.py:151} INFO - i7z0dcp
[2023-10-08T06:31:15.572+0000] {logging_mixin.py:151} INFO - i7yqa51
[2023-10-08T06:31:16.077+0000] {logging_mixin.py:151} INFO - i7yz705
[2023-10-08T06:31:16.592+0000] {logging_mixin.py:151} INFO - i7yzamw
[2023-10-08T06:31:17.103+0000] {logging_mixin.py:151} INFO - i7ykafn
[2023-10-08T06:31:17.637+0000] {logging_mixin.py:151} INFO - i7yuicf
[2023-10-08T06:31:18.244+0000] {logging_mixin.py:151} INFO - i7yzzo2
[2023-10-08T06:31:18.745+0000] {logging_mixin.py:151} INFO - i7yt6y2
[2023-10-08T06:31:19.255+0000] {logging_mixin.py:151} INFO - i7yk8jn
[2023-10-08T06:31:19.774+0000] {logging_mixin.py:151} INFO - i7yu626
[2023-10-08T06:31:20.235+0000] {logging_mixin.py:151} INFO - i7zdjlm
[2023-10-08T06:31:20.688+0000] {logging_mixin.py:151} INFO - i7yqdd6
[2023-10-08T06:31:21.099+0000] {logging_mixin.py:151} INFO - i7yyiaa
[2023-10-08T06:31:21.539+0000] {logging_mixin.py:151} INFO - i7z0h2d
[2023-10-08T06:31:22.025+0000] {logging_mixin.py:151} INFO - i7zirce
[2023-10-08T06:31:27.949+0000] {logging_mixin.py:151} INFO - i7yvbol
[2023-10-08T06:31:29.208+0000] {logging_mixin.py:151} INFO - i7yxrn9
[2023-10-08T06:31:29.744+0000] {logging_mixin.py:151} INFO - i7z2eh2
[2023-10-08T06:31:30.241+0000] {logging_mixin.py:151} INFO - i7z9vsn
[2023-10-08T06:31:30.799+0000] {logging_mixin.py:151} INFO - i7yqcom
[2023-10-08T06:31:31.287+0000] {logging_mixin.py:151} INFO - i7yrz2e
[2023-10-08T06:31:31.794+0000] {logging_mixin.py:151} INFO - i7zbc1b
[2023-10-08T06:31:32.537+0000] {logging_mixin.py:151} INFO - i7zkwe0
[2023-10-08T06:31:33.083+0000] {logging_mixin.py:151} INFO - i7yu6k3
[2023-10-08T06:31:33.622+0000] {logging_mixin.py:151} INFO - i7z65vo
[2023-10-08T06:31:34.135+0000] {logging_mixin.py:151} INFO - i7zd4b3
[2023-10-08T06:31:34.642+0000] {logging_mixin.py:151} INFO - i7yrmfr
[2023-10-08T06:31:35.175+0000] {logging_mixin.py:151} INFO - i7yyl73
[2023-10-08T06:31:35.790+0000] {logging_mixin.py:151} INFO - i7ymtk4
[2023-10-08T06:31:36.300+0000] {logging_mixin.py:151} INFO - i7ynguu
[2023-10-08T06:31:36.805+0000] {logging_mixin.py:151} INFO - i7z46fz
[2023-10-08T06:31:37.534+0000] {logging_mixin.py:151} INFO - i7yq7vg
[2023-10-08T06:31:38.090+0000] {logging_mixin.py:151} INFO - i7ytvup
[2023-10-08T06:31:38.597+0000] {logging_mixin.py:151} INFO - i7yxqby
[2023-10-08T06:31:39.171+0000] {logging_mixin.py:151} INFO - i7yy037
[2023-10-08T06:31:39.684+0000] {logging_mixin.py:151} INFO - i7zailv
[2023-10-08T06:31:40.198+0000] {logging_mixin.py:151} INFO - i7zhlbz
[2023-10-08T06:31:40.712+0000] {logging_mixin.py:151} INFO - i7z3yud
[2023-10-08T06:31:41.426+0000] {logging_mixin.py:151} INFO - i7zbqi1
[2023-10-08T06:31:42.049+0000] {logging_mixin.py:151} INFO - i7zbs8q
[2023-10-08T06:31:42.780+0000] {logging_mixin.py:151} INFO - i7zpl1v
[2023-10-08T06:31:43.668+0000] {logging_mixin.py:151} INFO - i7zvcjc
[2023-10-08T06:31:44.312+0000] {logging_mixin.py:151} INFO - i7zvtzt
[2023-10-08T06:31:44.921+0000] {logging_mixin.py:151} INFO - i818n68
[2023-10-08T06:31:45.542+0000] {logging_mixin.py:151} INFO - i8nrr4k
[2023-10-08T06:31:46.151+0000] {logging_mixin.py:151} INFO - i7yv996
[2023-10-08T06:31:46.766+0000] {logging_mixin.py:151} INFO - i7yy5w2
[2023-10-08T06:31:47.791+0000] {logging_mixin.py:151} INFO - i7yyb20
[2023-10-08T06:31:48.612+0000] {logging_mixin.py:151} INFO - i7yym17
[2023-10-08T06:31:49.083+0000] {logging_mixin.py:151} INFO - i7z1sm4
[2023-10-08T06:31:49.665+0000] {logging_mixin.py:151} INFO - i7z29q1
[2023-10-08T06:31:50.318+0000] {logging_mixin.py:151} INFO - i7z3gvy
[2023-10-08T06:31:50.829+0000] {logging_mixin.py:151} INFO - i7z3wln
[2023-10-08T06:31:51.348+0000] {logging_mixin.py:151} INFO - i7z6peo
[2023-10-08T06:31:51.872+0000] {logging_mixin.py:151} INFO - i7z7bd7
[2023-10-08T06:31:52.398+0000] {logging_mixin.py:151} INFO - i7ze1mt
[2023-10-08T06:31:52.925+0000] {logging_mixin.py:151} INFO - i7zha5l
[2023-10-08T06:31:53.464+0000] {logging_mixin.py:151} INFO - i8003ck
[2023-10-08T06:31:53.640+0000] {local_task_job_runner.py:294} WARNING - State of this instance has been externally set to failed. Terminating instance.
[2023-10-08T06:31:53.646+0000] {process_utils.py:131} INFO - Sending 15 to group 1604. PIDs of all processes in the group: [1604]
[2023-10-08T06:31:53.648+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 1604
[2023-10-08T06:31:53.651+0000] {taskinstance.py:1632} ERROR - Received SIGTERM. Terminating subprocesses.
[2023-10-08T06:31:53.653+0000] {taskinstance.py:1943} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/plugins/reddit_data_extractor.py", line 103, in extract_post_comment
    post_comments["comment_auther"].append(comment_data.author if comment_data.author else '')
  File "/home/airflow/.local/lib/python3.8/site-packages/praw/models/reddit/base.py", line 35, in __getattr__
    self._fetch()
  File "/home/airflow/.local/lib/python3.8/site-packages/praw/models/reddit/comment.py", line 188, in _fetch
    data = self._fetch_data()
  File "/home/airflow/.local/lib/python3.8/site-packages/praw/models/reddit/base.py", line 89, in _fetch_data
    return self._reddit.request(method="GET", params=params, path=path)
  File "/home/airflow/.local/lib/python3.8/site-packages/praw/util/deprecate_args.py", line 43, in wrapped
    return func(**dict(zip(_old_args, args)), **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/praw/reddit.py", line 941, in request
    return self._core.request(
  File "/home/airflow/.local/lib/python3.8/site-packages/prawcore/sessions.py", line 328, in request
    return self._request_with_retries(
  File "/home/airflow/.local/lib/python3.8/site-packages/prawcore/sessions.py", line 234, in _request_with_retries
    response, saved_exception = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/prawcore/sessions.py", line 186, in _make_request
    response = self._rate_limiter.call(
  File "/home/airflow/.local/lib/python3.8/site-packages/prawcore/rate_limit.py", line 47, in call
    response = request_function(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/prawcore/requestor.py", line 70, in request
    raise RequestException(exc, args, kwargs) from None
prawcore.exceptions.RequestException: error with request Task received SIGTERM signal
[2023-10-08T06:31:53.692+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=Reddit_Post_Comment_Dag, task_id=extract_post_comment_task, execution_date=20231008T061144, start_date=20231008T063103, end_date=20231008T063153
[2023-10-08T06:31:53.718+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 163 for task extract_post_comment_task (error with request Task received SIGTERM signal; 1604)
[2023-10-08T06:31:53.784+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=1604, status='terminated', exitcode=1, started='06:31:02') (1604) terminated with exit code 1
